#!/usr/bin/bash
REG='[0-9 .]+>[0-9 .]+'

if [ "$#" -ne 1 ] ; then
	echo "no log file"
	exit 1
fi

FILE=${1}

echo "src ips"
SRCS_IPS=$(cut -d '>' -f 1 $FILE | awk '{print $NF}' | grep -Eo "$IP_REG" | sort | uniq)
for X in $SRCS_IPS ; do echo $X ; done
echo 

echo "dest ips"
DEST_IPS=$(cut -d '>' -f 2 $FILE | awk '{print $1}' | grep -Eo "$IP_REG" | sort | uniq)
for X in $DEST_IPS ; do echo $X ; done
echo 

echo
echo "src port"
SRCS_PORTS=$(cut -d '>' -f 1 $FILE | awk '{print $NF}' | awk -F'.' '{print $NF}' | sed 's/://' | sort | uniq)
for X in $SRCS_PORTS ; do echo $X ; done
echo 

echo "dest ports"
DEST_PORTS=$(cut -d '>' -f 2 $FILE | awk '{print $1}' | awk -F'.' '{print $NF}' | sed 's/://' | sort | uniq)
for X in $DEST_PORTS ; do echo $X ; done
echo 

echo "from $FILE:"
echo
echo all ips
grepip $FILE

exit 0

